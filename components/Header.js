import React from "react";
import classNames from "classnames";
import Link from "next/link";
import { useRouter } from "next/router";

const navLinks = [
  { url: "/our-work", title: "Our Work" },
  { url: "/our-services", title: "Our Services" },
  { url: "/about-us", title: "About Us" },
  { url: "/careers", title: "Careers" },
  { url: "/contact", title: "Contact" },
];

// the site-wide Header
class Header extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      navActive: false,
    };

    this.toggleMenu = this.toggleMenu.bind(this);
    this.handleResize = this.handleResize.bind(this);
  }

  componentDidMount() {
    const body = document.querySelector("body");
    if (body) {
      body.classList.remove("nav-open"); // ensure this doesn't get stuck on the body when navigating
    }
    window.addEventListener("resize", this.handleResize);
  }

  componentWillUnmount() {
    window.removeEventListener("resize", this.handleResize);
  }

  toggleMenu() {
    const body = document.querySelector("body");
    if (body) {
      if (!this.state.navActive) {
        body.classList.add("nav-open");
      } else {
        body.classList.remove("nav-open");
      }
    }

    this.setState({
      navActive: !this.state.navActive,
    });
  }

  // this just handles when the nav is left open, then the window gets resized
  handleResize() {
    if (this.state.navActive && window.innerWidth > 991) {
      const body = document.querySelector("body");
      if (body) {
        body.classList.remove("nav-open");
      }
      this.setState({
        navActive: false,
      });
    }
  }

  render() {
    const { inlineHeader } = this.props;
    const headerClasses = classNames(
      { "nav-active": this.state.navActive },
      { "nav-inline": inlineHeader }
    );
    const headerNavClasses = classNames("header-nav", {
      active: this.state.navActive,
    });

    return (
      <header id={`header-main`} className={headerClasses}>
        <Link href="/" legacyBehavior>
          <div title="Home" className="header-logo-link">
            <a href="/">
              <svg id="header-logo" data-name="Layer 1" viewBox="0 0 308.96 46.16" width="350px">
                <title>evanshunt logo</title>
                <defs/>
                <g id="part-of">
                <path d="M236.75,26.98c0,.61.26.74,1.24.82v.29h-3.06v-.27c.74-.09.88-.14.88-.71v-5.06c0-.57-.14-.62-.88-.71v-.27h2.64c1.8,0,2.65.97,2.65,2.05,0,1.23-.87,2.1-2.61,2.1h-.86v1.76ZM236.75,24.89h.66c1.26,0,1.78-.63,1.78-1.73,0-.95-.52-1.76-1.78-1.76h-.66v3.49Z"/>
                <path d="M244.42,26.98c0,.44.1.66.39.66.16,0,.31-.06.46-.13l.05.15c-.24.36-.58.53-.96.53-.49,0-.78-.35-.83-.91-.35.41-.91.91-1.61.91-.78,0-1.27-.51-1.27-1.25,0-.84.63-1.19,1.42-1.49l1.44-.54v-.68c0-.69-.26-1.19-.92-1.19-.57,0-.81.38-.81.89,0,.17.02.32.07.52l-.53.08c-.25-.08-.39-.27-.39-.55,0-.75.78-1.19,1.79-1.19,1.14,0,1.7.49,1.7,1.54v2.65ZM243.51,27.07v-1.88l-1.2.49c-.5.2-.79.48-.79,1.01s.3.91.87.91c.41,0,.71-.19,1.12-.53Z"/>
                <path d="M247.08,27.33c0,.39.23.47.89.5v.26h-2.48v-.26c.53-.03.69-.11.69-.5v-3.58l-.65-.35v-.11l1.47-.5h.12l-.04,1.42c.55-1.02.79-1.42,1.35-1.42.18,0,.31.07.38.16v.75h-.14c-.61,0-1.03.05-1.59.73v2.9Z"/>
                <path d="M250.62,22.89h1.43v.38h-1.43v3.31c0,.74.27,1.04.83,1.04.31,0,.52-.09.79-.29l.09.12c-.26.38-.7.74-1.32.74-.72,0-1.27-.39-1.27-1.46v-3.46h-.68v-.14c.57-.31,1.03-.85,1.36-1.48h.2v1.24Z"/>
                <path d="M254.67,25.62c0-1.72,1.05-2.83,2.38-2.83,1.4,0,2.32,1.06,2.32,2.57,0,1.72-1.05,2.83-2.38,2.83-1.4,0-2.32-1.04-2.32-2.57ZM258.41,25.61c0-1.32-.45-2.51-1.42-2.51-.89,0-1.38.92-1.38,2.27s.45,2.51,1.42,2.51c.89,0,1.38-.92,1.38-2.27Z"/>
                <path d="M261.4,27.33c0,.39.23.47.89.5v.26h-2.48v-.26c.53-.03.69-.11.69-.5v-4.06h-.74v-.14l.74-.3v-.67c0-1.23.69-1.9,1.77-1.9.69,0,1.05.25,1.05.72,0,.22-.11.4-.29.5h-.52c.02-.1.03-.2.03-.34,0-.38-.13-.64-.48-.64-.42,0-.66.38-.66,1.1v1.29h1.29v.38h-1.29v4.06Z"/>
                <path d="M266.41,22.89h1.43v.38h-1.43v3.31c0,.74.27,1.04.83,1.04.31,0,.52-.09.79-.29l.09.12c-.26.38-.7.74-1.32.74-.72,0-1.27-.39-1.27-1.46v-3.46h-.68v-.14c.57-.31,1.03-.85,1.36-1.48h.2v1.24Z"/>
                <path d="M268.99,21.23l-.65-.35v-.11l1.43-.5h.12v3.48c.47-.52,1.05-.95,1.82-.95.92,0,1.35.56,1.35,1.64v2.9c0,.39.16.47.69.5v.26h-2.28v-.26c.53-.03.69-.11.69-.5v-2.91c0-.74-.3-1.05-.89-1.05-.51,0-1,.28-1.38.61v3.35c0,.39.16.47.69.5v.26h-2.28v-.26c.53-.03.69-.11.69-.5v-6.11Z"/>
                <path d="M278.24,24.77v.21h-3.32c-.07,1.62.73,2.54,1.77,2.54.72,0,1.15-.34,1.5-.89l.12.06c-.24.87-.93,1.5-1.97,1.5-1.42,0-2.23-1.15-2.23-2.55,0-1.64.96-2.85,2.25-2.85s1.88.86,1.88,1.98ZM274.96,24.69h2.42c0-.9-.31-1.58-1.09-1.58s-1.23.69-1.33,1.58Z"/>
                </g>
                <g id="mod-op">
                <path d="M241.68,36.41c0-.66-.22-.97-.78-.97-.46,0-.83.24-1.18.52v3.37c0,.37.14.44.64.47v.29h-2.41v-.29c.5-.03.65-.1.65-.47v-2.92c0-.66-.23-.97-.79-.97-.46,0-.83.24-1.18.52v3.37c0,.37.15.44.65.47v.29h-2.43v-.29c.5-.03.66-.1.66-.47v-3.57l-.63-.35v-.14l1.62-.52h.17l-.04.96c.45-.52.96-.96,1.77-.96.72,0,1.12.31,1.26.99.45-.52,1.02-.99,1.82-.99.91,0,1.32.55,1.32,1.62v2.96c0,.37.16.44.66.47v.29h-2.42v-.29c.5-.03.64-.1.64-.47v-2.92Z"/>
                <path d="M243.81,37.59c0-1.71,1.08-2.84,2.48-2.84s2.43,1.05,2.43,2.59c0,1.72-1.08,2.85-2.48,2.85s-2.43-1.04-2.43-2.6ZM247.53,37.64c0-1.4-.4-2.56-1.3-2.56-.82,0-1.24.89-1.24,2.22s.4,2.56,1.29,2.56c.82,0,1.25-.89,1.25-2.22Z"/>
                <path d="M252.3,32.91v-.15l1.59-.49h.16v6.82c0,.34.02.43.44.47l.26.02v.26l-1.66.36h-.2l.04-.93c-.4.55-.9.93-1.61.93-1.22,0-2.01-1.01-2.01-2.47,0-1.85,1.08-2.96,2.49-2.96.49,0,.88.14,1.13.37v-1.89l-.63-.34ZM250.39,37.28c0,1.22.53,2.16,1.52,2.16.42,0,.76-.14,1.02-.41v-2.56c0-.86-.42-1.37-1.06-1.37-.91,0-1.48.87-1.48,2.18Z"/>
                <path d="M257.12,37.59c0-1.71,1.08-2.84,2.48-2.84s2.43,1.05,2.43,2.59c0,1.72-1.08,2.85-2.48,2.85s-2.43-1.04-2.43-2.6ZM260.84,37.64c0-1.4-.4-2.56-1.3-2.56-.82,0-1.24.89-1.24,2.22s.4,2.56,1.29,2.56c.82,0,1.25-.89,1.25-2.22Z"/>
                <path d="M263.04,35.76l-.63-.35v-.14l1.61-.52h.18l-.04.91c.36-.52.9-.91,1.68-.91,1.24,0,1.98.92,1.98,2.41,0,1.9-1.15,3.03-2.59,3.03-.42,0-.82-.11-1.07-.32v1.55c0,.4.19.45.86.5v.29h-2.64v-.29c.5-.03.66-.1.66-.47v-5.69ZM266.68,37.6c0-1.17-.43-2.16-1.48-2.16-.4,0-.8.19-1.05.46v2.75c0,.83.37,1.21,1.04,1.21.92,0,1.49-.99,1.49-2.26Z"/>
                </g>
                <g id="network">
                <path d="M274.21,36.42c0-.74-.3-1.05-.89-1.05-.51,0-1,.28-1.38.61v3.35c0,.39.16.47.69.5v.26h-2.28v-.26c.53-.03.69-.11.69-.5v-3.58l-.65-.35v-.11l1.47-.5h.12l-.04.95c.47-.52,1.05-.95,1.82-.95.92,0,1.35.53,1.35,1.61v2.93c0,.39.16.47.69.5v.26h-2.28v-.26c.53-.03.69-.11.69-.5v-2.91Z"/>
                <path d="M280.3,36.77v.21h-3.32c-.07,1.62.73,2.54,1.77,2.54.72,0,1.15-.34,1.5-.89l.12.06c-.24.87-.93,1.5-1.97,1.5-1.42,0-2.23-1.15-2.23-2.55,0-1.64.96-2.85,2.25-2.85s1.88.86,1.88,1.98ZM277.01,36.69h2.42c0-.9-.31-1.58-1.09-1.58s-1.23.69-1.33,1.58Z"/>
                <path d="M282.15,34.89h1.43v.38h-1.43v3.31c0,.74.27,1.04.83,1.04.31,0,.52-.09.79-.29l.09.12c-.26.38-.7.74-1.32.74-.72,0-1.27-.39-1.27-1.46v-3.46h-.68v-.14c.57-.31,1.03-.85,1.36-1.48h.2v1.24Z"/>
                <path d="M290.48,35.75c.03-.08.04-.17.04-.24,0-.26-.25-.3-.68-.36v-.26h1.62v.26c-.37.09-.43.16-.51.37l-1.82,4.67h-.24l-1.21-3.39-1.27,3.39h-.23l-1.86-4.67c-.09-.21-.14-.28-.51-.37v-.26h2.19v.26c-.44.06-.68.1-.68.36,0,.07,0,.15.04.24l1.19,3.18.97-2.63-.28-.78c-.07-.21-.14-.28-.51-.37v-.26h2.09v.26c-.44.06-.68.09-.68.36,0,.07,0,.14.04.24l1.09,3.16,1.21-3.16Z"/>
                <path d="M291.51,37.62c0-1.72,1.05-2.83,2.38-2.83,1.4,0,2.32,1.06,2.32,2.57,0,1.72-1.05,2.83-2.38,2.83-1.4,0-2.32-1.04-2.32-2.57ZM295.25,37.61c0-1.32-.45-2.51-1.42-2.51-.89,0-1.38.92-1.38,2.27s.45,2.51,1.42,2.51c.89,0,1.38-.92,1.38-2.27Z"/>
                <path d="M298.24,39.33c0,.39.23.47.89.5v.26h-2.48v-.26c.53-.03.69-.11.69-.5v-3.58l-.65-.35v-.11l1.47-.5h.12l-.04,1.42c.55-1.02.79-1.42,1.35-1.42.18,0,.31.07.38.16v.75h-.14c-.61,0-1.03.05-1.59.73v2.9Z"/>
                <path d="M300.9,33.23l-.65-.35v-.11l1.43-.5h.12v7.07c0,.39.16.47.69.5v.26h-2.28v-.26c.53-.03.69-.11.69-.5v-6.11ZM303.53,35.77c.13-.12.25-.23.25-.36,0-.2-.2-.2-.67-.26v-.26h1.98v.26c-.39.09-.57.18-.79.38l-1.52,1.38,2.55,2.99v.19h-1.01l-2.4-2.85,1.61-1.47Z"/>
                </g>
                
                <line id="separator" x1="226.05" y1="41.01" x2="226.05" y2="20.13" fill="none" stroke="" />
                <g id="evans-hunt">
                <path d="M58.94,22.64c-2.1.46-3.9.75-5.63,1.26-1.45.43-2.34,1.53-2.39,3.1-.06,1.96-.1,3.93.01,5.88.15,2.59,1.86,3.91,4.41,3.6,1.54-.19,2.91-1.42,3.1-3.41.32-3.36.34-6.75.49-10.43M50.9,16.33h-5.2c.2-2.4.18-4.77.66-7.03.54-2.54,2.41-4.09,4.89-4.83,2.13-.64,4.31-.69,6.48-.19,3.73.85,5.99,3.53,6.04,7.37.08,6.43.04,12.86.05,19.29,0,3.01,0,6.03,0,9.12h-4.5c-.12-.62-.24-1.29-.39-2.07-.23.2-.46.36-.65.56-2.23,2.3-4.95,2.75-7.84,1.76-2.92-1-4.32-3.38-4.49-6.34-.17-2.88-.13-5.77,0-8.66.11-2.48,1.33-4.41,3.79-5.12,2.42-.69,4.93-1.07,7.4-1.58.51-.1,1.03-.16,1.62-.25,0-2.15.12-4.25-.03-6.33-.19-2.63-1.65-3.79-4.26-3.7-2.19.08-3.48,1.5-3.56,4.01-.04,1.26,0,2.53,0,3.97"/>
                <path d="M16.37,19.57c.07-.15.13-.22.13-.3.02-1.79.06-3.59.02-5.38-.03-1.04-.08-2.11-.34-3.11-.44-1.65-1.71-2.43-3.59-2.43-1.92,0-3.35.73-3.57,2.41-.37,2.91-.37,5.86-.53,8.81h7.88ZM21.45,27.99c0,2.23.24,4.4-.05,6.5-.55,4.02-3.34,6.15-8.02,6.37-1.25.06-2.55-.05-3.77-.31-3.74-.81-5.91-3.49-5.94-7.41-.06-6.78.02-13.56-.04-20.35-.05-6.83,4.39-9.24,10.03-8.76,5.45.46,7.84,3.19,7.92,8.65.05,3.67,0,7.34,0,11.21h-12.96c0,.57-.01,1.08,0,1.58.08,2.75,0,5.51.31,8.24.22,1.97,1.57,2.8,3.65,2.81,2.07,0,3.32-.81,3.67-2.8.32-1.83.29-3.73.42-5.71h4.78Z"/>
                <path d="M69.08,4.78h4.36c.12.73.23,1.44.37,2.34,1.43-1.68,2.99-2.84,5.15-2.98,4.65-.29,7.79,2.38,7.9,7.07.13,5.55.06,11.11.07,16.67,0,4.02,0,8.05,0,12.17h-5v-1.39c0-8.27,0-16.54,0-24.8,0-.87-.01-1.76-.2-2.6-.43-1.92-1.43-2.8-3.05-2.89-2.02-.12-3.41.62-4.03,2.42-.38,1.09-.59,2.3-.59,3.45-.05,8.09-.03,16.19-.03,24.28v1.53h-4.93V4.78Z"/>
                <path d="M109.56,15.93h-5.11c-.07-1.35-.09-2.65-.21-3.94-.23-2.38-1.41-3.58-3.48-3.65-2.54-.08-3.75.86-4.23,3.29-.81,4.13.17,6.06,3.99,7.88,1.49.71,3.02,1.37,4.48,2.15,2.51,1.35,4.15,3.41,4.3,6.31.12,2.34.12,4.73-.22,7.04-.4,2.65-2.13,4.45-4.73,5.27-2.34.74-4.72.83-7.11.23-3.52-.88-5.34-2.96-5.78-6.87-.2-1.8-.03-3.65-.03-5.58h4.88c.02.42.04.88.06,1.34.07,1.26.03,2.54.22,3.78.37,2.4,1.63,3.38,4.05,3.32,2.11-.05,3.33-1.24,3.61-3.54.05-.43.07-.87.12-1.31.4-3.22-1.01-5.35-3.9-6.66-1.63-.74-3.22-1.55-4.78-2.42-2.98-1.68-4.37-4.31-4.3-7.69.03-1.65,0-3.35.37-4.94,1.09-4.68,5.09-6.35,9.74-5.9,4.42.43,6.89,2.32,7.58,5.82.39,1.94.34,3.97.49,6.07"/>
                <path d="M37.91,40.1h-8.27c-1.76-11.74-3.52-23.46-5.29-35.29h4.99c1.43,10,2.86,20.04,4.29,30.08.07,0,.15.01.22.02,1.41-10.01,2.83-20.02,4.25-30.11h4.99c-1.73,11.76-3.45,23.47-5.2,35.3"/>
                <polygon points="126.16 24.26 126.16 40.11 121.2 40.11 121.2 4.85 126.08 4.85 126.08 19.7 134.07 19.7 134.07 4.87 139.08 4.87 139.08 40.11 134.17 40.11 134.17 24.26 126.16 24.26"/>
                <path d="M172.77,40.16h-4.95V4.89h4.45c.09.71.19,1.42.31,2.34,1.43-1.75,3.02-2.87,5.16-3.02,4.37-.32,7.33,2.07,7.86,6.43.08.69.12,1.4.13,2.09,0,8.79,0,17.58,0,26.38,0,.3-.03.61-.05,1.01h-4.96v-1.54c0-8.18,0-16.36-.01-24.54,0-.95-.04-1.93-.26-2.86-.4-1.73-1.4-2.6-2.92-2.74-1.9-.17-3.34.46-3.95,2.12-.47,1.28-.76,2.71-.78,4.07-.07,8-.04,16.01-.04,24.01v1.52"/>
                <path d="M157.31,4.85h4.94v35.28h-4.37c-.1-.69-.21-1.4-.32-2.17-.16.08-.28.1-.35.18-2.35,2.58-5.22,3.41-8.28,2.28-3.13-1.15-4.31-3.73-4.47-6.79-.16-2.97-.06-5.95-.06-8.92,0-6.3,0-12.6,0-18.89,0-.3.03-.59.06-.96h4.94v1.5c0,8.27,0,16.53.01,24.8,0,.87.05,1.75.24,2.6.4,1.76,1.36,2.64,2.86,2.81,1.93.21,3.43-.45,4.05-2.16.47-1.28.72-2.71.73-4.08.07-7.96.03-15.92.03-23.88v-1.59Z"/>
                <polygon points="189.07 4.87 189.07 9.08 194.06 9.08 194.06 40.12 199.13 40.12 199.13 9.06 204.1 9.06 204.1 4.87 189.07 4.87"/>
                </g>
              </svg>
            </a>
            
          </div>
        </Link>
        <button
          className={classNames("header-nav-toggle", {
            active: this.state.navActive,
          })}
          onClick={this.toggleMenu}
          aria-label="Toggle navigation"
        >
          <div>
            <span className="icon-bar"></span>
            <span className="icon-bar"></span>
            <span className="icon-bar"></span>
          </div>
        </button>

        <nav className={headerNavClasses}>
          <div className="header-nav-links">
            {navLinks.map((navLink, i) => {
              return <NavLink navLink={navLink} key={i} />;
            })}
          </div>

          <div className="header-nav-contact-box">
            <div className="header-nav-contact">
              <h4 className="header-nav-contact-heading">Get in touch</h4>
              <a
                target="_blank"
                rel="noreferrer"
                className={"header-nav-contact-link"}
                href="mailto:info@evanshunt.com"
              >
                info@evanshunt.com
              </a>
            </div>
          </div>
        </nav>
      </header>
    );
  }
}

// this just allows for the active class to be added
const NavLink = ({ navLink }) => {
  const router = useRouter();
  const classes = classNames("header-nav-link", {
    active: router.pathname.indexOf(navLink.url) !== -1,
  });
  return (
    <Link href={navLink.url} legacyBehavior>
      <a className={classes} title={navLink.title}>
        <span>{navLink.title}</span>
      </a>
    </Link>
  );
};

export default Header;
